<!DOCTYPE html>
<html>
    <head>
        <head>
            <meta charset='utf-8'>
            <meta http-equiv='X-UA-Compatible' content='IE=edge'>
            <title>Web 3 Demo</title>
            <meta name='viewport' content='width=device-width, initial-scale=1'>
            <link rel="stylesheet" href="style_devis.css">
            <script src="https://kit.fontawesome.com/b99e675b6e.js"></script>
            <script src="https://cdn.jsdelivr.net/npm/web3@latest/dist/web3.min.js"></script>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.70/pdfmake.min.js"></script>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.70/vfs_fonts.js"></script>
            <script type="text/javascript" src="abi2.js"></script>
        </head>
    </head>

<body>
    <body onload="createTable()">
        <div class="wrapper">
            <div class="sidebar">
              <h2><i class="fas fa-tools"></i> My Repair</h2>
                <ul>
                    <li><a href="profilClient.html"><i class="fas fa-user-circle"></i>Profil client</a></li>
                    <li><a href="deployContract.html"><i class="fas fa-shopping-cart"></i>Nouvel appareil</a></li>
                    <li><a href="infoContrat.html"><i class="fas fa-list-ol"></i>Mes contrats</a></li>            
                </ul> 
            </div>
            <div class="main_content">
                <div class="header">Mes contrats</div>  
                <div class="app">
                  <h1>Appareil XXXX</h1>
                  <div class="info">
                      <h2><i class="fas fa-info" style="color:black"></i> Nouveau document</h2>

                        <form id="Data">
                            <fieldset>
                            <legend><b>Informations</b></legend>
                            <div>
                                &emsp;<select id = "type_doc" class = "type_doc_select" required>
                                    <option value="">--Type document--</option>
                                    <option value="Devis">Devis</option>
                                    <option value="Facture">Facture</option>
                                </select><br><br>  
                                &emsp;Devis établi par : <input id="intervenant" type="text" value="" required/>
                                
                            </div>
                            </fieldset><br>
                        </form>

                        <p>
                        Ajouter un élément : <input type="button" id="addRow" value="Ajouter" onclick="addRow()" />
                        </p>
                        
                        <div id="cont"></div>  <!-- the container to add the TABLE -->
                        
                        <br><br><p>
                        <button id="bt" class="button1" onclick="submit()"><i class="fas fa-save"></i> Valider</button>
                        <button class="button1"><a href="infoContrat.html"><i class="fas fa-arrow-left"></i> Retour</a></button>
                        </p>
                            
                        <p id='output'></p>
        
        
        <script>
            var arrHead = new Array();	// array for header.
            arrHead = ['', 'Description', 'Quantité', 'Prix unitaire'];
        
            // first create TABLE structure with the headers. 
            function createTable() {
                var empTable = document.createElement('table');
                empTable.setAttribute('id', 'empTable'); // table id.
        
                var tr = empTable.insertRow(-1);
                for (var h = 0; h < arrHead.length; h++) {
                    var th = document.createElement('th'); // create table headers
                    th.innerHTML = arrHead[h];
                    tr.appendChild(th);
                }
        
                var div = document.getElementById('cont');
                div.appendChild(empTable);  // add the TABLE to the container.
            }
        
            // now, add a new to the TABLE.
            function addRow() {
                var empTab = document.getElementById('empTable');
        
                var rowCnt = empTab.rows.length;   // table row count.
                var tr = empTab.insertRow(rowCnt); // the table row.
                tr = empTab.insertRow(rowCnt);
        
                for (var c = 0; c < arrHead.length; c++) {
                    var td = document.createElement('td'); // table definition.
                    td = tr.insertCell(c);
        
                    if (c == 0) {      // the first column.
                        // add a button in every new row in the first column.
                        var button = document.createElement('input');
        
                        // set input attributes.
                        button.setAttribute('type', 'button');
                        button.setAttribute('value', 'Supprimer');
        
                        // add button's 'onclick' event.
                        button.setAttribute('onclick', 'removeRow(this)');
        
                        td.appendChild(button);
                    }
                    else if (c == 1) {
                        // 2nd, 3rd and 4th column, will have textbox.
                        var ele = document.createElement('input');
                        ele.setAttribute('type', 'text');
                        ele.setAttribute('value', '');
        
                        td.appendChild(ele);
                    }
                    else {
                        var ele = document.createElement('input');
                        ele.setAttribute('type', 'number');
                        ele.setAttribute('value', '');
                        ele.setAttribute('min', '0');
        
                        td.appendChild(ele);

                    }
                }
            }
        
            // delete TABLE row function.
            function removeRow(oButton) {
                var empTab = document.getElementById('empTable');
                empTab.deleteRow(oButton.parentNode.parentNode.rowIndex); // button -> td -> tr.
            }
        
            // function to extract and submit table data.
            function submit() {
                var myTab = document.getElementById('empTable');
                var arrValues = new Array();
                var total = new Array()
        
                // loop through each row of the table.
                for (row = 1; row < myTab.rows.length - 1; row++) {
                    // loop through each cell in a row.
                    for (c = 0; c < myTab.rows[row].cells.length; c++) {  
                        var element = myTab.rows.item(row).cells[c];
                        if (element.childNodes[0].getAttribute('type') == 'text'|| element.childNodes[0].getAttribute('type') == 'number') {
                            arrValues.push(element.childNodes[0].value);
                        }
                    }
                }
                
                // The final output.
                document.getElementById('output').innerHTML = arrValues;
                console.log (arrValues);   // you can see the array values in your browsers console window. Thanks :-) 
            }
        </script>

    </body>
</html>